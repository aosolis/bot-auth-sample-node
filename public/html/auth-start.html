<html>
<head>
    <title>Sign In</title>
</head>
<body>
    <script src="https://statics.teams.microsoft.com/sdk/v1.2/js/MicrosoftTeams.min.js" integrity="sha384-OncOcMprEYFkUvhe15zi8VdCZIOcuNGnf4ilq2yTfDEjTwPF19V7pZrzxOq/iqt0" crossorigin="anonymous"></script>
    <script type="text/javascript">
        microsoftTeams.initialize();

        // Parse query parameters
        let queryParams = {};
        location.search.substr(1).split("&").forEach(function(item) {
            let s = item.split("="),
            k = s[0],
            v = s[1] && decodeURIComponent(s[1]);
            queryParams[k] = v;
        });

        function isValidAuthorizationUrl(url) {
            return url.match(/^https:\/\/www\.linkedin\.com\/oauth\/v2\/authorization\?/) ||
                url.match(/^https:\/\/login\.microsoftonline\.com\/common\/oauth2\/authorize\?/);
        }

        let authorizationUrl = queryParams["authorizationUrl"];
        if (!authorizationUrl || !isValidAuthorizationUrl(authorizationUrl)) {
            microsoftTeams.authentication.notifyFailure("Invalid authorization url");
        } else {
            window.location.assign(authorizationUrl);
        }
    </script>
</body>
</html>